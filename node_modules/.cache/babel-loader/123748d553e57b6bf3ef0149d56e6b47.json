{"ast":null,"code":"import _slicedToArray from\"/home/robin/Desktop/robin/econ/shopbackend/shopfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Form,Button,Row,Col,Table}from\"react-bootstrap\";import{LinkContainer}from\"react-router-bootstrap\";import{Loader}from\"../Loader\";import Message from\"../Message\";import{useDispatch,useSelector}from\"react-redux\";import{getUserDetails,updateUserProfile}from\"../../actions/userActions\";import{USER_UPDATE_PROFILE_RESET}from\"../../constants/userConstants\";import{ListMyOrders}from\"../../actions/orderActions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ProfileScreen=function ProfileScreen(_ref){var history=_ref.history;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),confirmPassword=_useState6[0],setConfirmPassword=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),message=_useState10[0],setMessage=_useState10[1];var dispatch=useDispatch();var userDetails=useSelector(function(state){return state.userDetails;});var error=userDetails.error,loading=userDetails.loading,user=userDetails.user;var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var userUpdateProfile=useSelector(function(state){return state.userUpdateProfile;});var success=userUpdateProfile.success;var orderListMy=useSelector(function(state){return state.orderListMy;});var loadingOrders=orderListMy.loading,errorOrders=orderListMy.error,orders=orderListMy.orders;useEffect(function(){if(!userInfo){history.push('/login');}else{if(!user||!user.name||success||userInfo._id!==user._id){dispatch({type:USER_UPDATE_PROFILE_RESET});dispatch(getUserDetails('profile'));dispatch(ListMyOrders());}else{setName(user.name);setEmail(user.email);}}},[dispatch,history,userInfo,user,success]);var submitHandler=function submitHandler(e){e.preventDefault();if(password!==confirmPassword){setMessage('password does not match');}else{dispatch(updateUserProfile({'id':user._id,'name':name,'email':email,'password':password}));setMessage('');}};return/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:3,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Profile\"}),message&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:message}),error&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}),loading&&/*#__PURE__*/_jsx(Loader,{}),/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"name\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Name\"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"name\",placeholder:\"Enter Name\",value:name,onChange:function onChange(e){return setName(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"email\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email Address\"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"email\",placeholder:\"Enter Email\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"password\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"Enter Password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"passwordConfirm\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Confirm Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"Enter ConfirmPassword\",value:confirmPassword,onChange:function onChange(e){return setConfirmPassword(e.target.value);}})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",children:\"Update\"})]})]}),/*#__PURE__*/_jsxs(Col,{md:9,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"My Orders\"}),loadingOrders?/*#__PURE__*/_jsx(Loader,{}):errorOrders?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:errorOrders}):/*#__PURE__*/_jsxs(Table,{striped:true,responsive:true,className:\"table-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Paid\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Delivered\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map(function(order){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order._id}),/*#__PURE__*/_jsx(\"td\",{children:order.createdAt.substring(0,10)}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",order.totalPrice]}),/*#__PURE__*/_jsx(\"td\",{children:order.isPaid?order.paidAt.substring(0,10):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",style:{color:'red'}})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(LinkContainer,{to:\"/order/\".concat(order._id),children:/*#__PURE__*/_jsx(Button,{className:\"btn-sm\",children:\"Details\"})})})]},order._id);})})]})]})]});};export default ProfileScreen;","map":{"version":3,"sources":["/home/robin/Desktop/robin/econ/shopbackend/shopfrontend/src/components/Screens/ProfileScreen.js"],"names":["React","useState","useEffect","Form","Button","Row","Col","Table","LinkContainer","Loader","Message","useDispatch","useSelector","getUserDetails","updateUserProfile","USER_UPDATE_PROFILE_RESET","ListMyOrders","ProfileScreen","history","name","setName","email","setEmail","confirmPassword","setConfirmPassword","password","setPassword","message","setMessage","dispatch","userDetails","state","error","loading","user","userLogin","userInfo","userUpdateProfile","success","orderListMy","loadingOrders","errorOrders","orders","push","_id","type","submitHandler","e","preventDefault","target","value","map","order","createdAt","substring","totalPrice","isPaid","paidAt","color"],"mappings":"8KACA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CAEA,OAASC,IAAT,CAAeC,MAAf,CAAuBC,GAAvB,CAA4BC,GAA5B,CAAgCC,KAAhC,KAA6C,iBAA7C,CACA,OAASC,aAAT,KAA8B,wBAA9B,CACA,OAAQC,MAAR,KAAqB,WAArB,CACA,MAAOC,CAAAA,OAAP,KAAoB,YAApB,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,cAAT,CAAyBC,iBAAzB,KAAkD,2BAAlD,CACA,OAASC,yBAAT,KAA0C,+BAA1C,CACA,OAASC,YAAT,KAA6B,4BAA7B,C,wFAGA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,MAAe,IAAbC,CAAAA,OAAa,MAAbA,OAAa,eAETjB,QAAQ,CAAC,EAAD,CAFC,wCAE1BkB,IAF0B,eAEpBC,OAFoB,8BAGPnB,QAAQ,CAAC,EAAD,CAHD,yCAG1BoB,KAH0B,eAGnBC,QAHmB,8BAIarB,QAAQ,CAAC,EAAD,CAJrB,yCAI1BsB,eAJ0B,eAITC,kBAJS,8BAKDvB,QAAQ,CAAC,EAAD,CALP,yCAK1BwB,QAL0B,eAKhBC,WALgB,8BAMHzB,QAAQ,CAAC,EAAD,CANL,0CAM1B0B,OAN0B,gBAMjBC,UANiB,gBASjC,GAAMC,CAAAA,QAAQ,CAAGlB,WAAW,EAA5B,CAIA,GAAMmB,CAAAA,WAAW,CAAGlB,WAAW,CAAC,SAAAmB,KAAK,QAAIA,CAAAA,KAAK,CAACD,WAAV,EAAN,CAA/B,CAbiC,GAczBE,CAAAA,KAdyB,CAcDF,WAdC,CAczBE,KAdyB,CAclBC,OAdkB,CAcDH,WAdC,CAclBG,OAdkB,CAcTC,IAdS,CAcDJ,WAdC,CAcTI,IAdS,CAgBjC,GAAMC,CAAAA,SAAS,CAAGvB,WAAW,CAAC,SAAAmB,KAAK,QAAIA,CAAAA,KAAK,CAACI,SAAV,EAAN,CAA7B,CAhBiC,GAiBzBC,CAAAA,QAjByB,CAiBbD,SAjBa,CAiBzBC,QAjByB,CAqBjC,GAAMC,CAAAA,iBAAiB,CAAGzB,WAAW,CAAC,SAAAmB,KAAK,QAAIA,CAAAA,KAAK,CAACM,iBAAV,EAAN,CAArC,CArBiC,GAsBzBC,CAAAA,OAtByB,CAsBbD,iBAtBa,CAsBzBC,OAtByB,CAyBjC,GAAMC,CAAAA,WAAW,CAAI3B,WAAW,CAAC,SAAAmB,KAAK,QAAIA,CAAAA,KAAK,CAACQ,WAAV,EAAN,CAAhC,CAzBiC,GA0BjBC,CAAAA,aA1BiB,CA0B0BD,WA1B1B,CA0BzBN,OA1ByB,CA0BGQ,WA1BH,CA0B0BF,WA1B1B,CA0BHP,KA1BG,CA0BeU,MA1Bf,CA0B0BH,WA1B1B,CA0BeG,MA1Bf,CA4BjCxC,SAAS,CAAC,UAAM,CACd,GAAI,CAACkC,QAAL,CAAe,CACblB,OAAO,CAACyB,IAAR,CAAa,QAAb,EACD,CAFD,IAEK,CACD,GAAG,CAACT,IAAD,EAAS,CAACA,IAAI,CAACf,IAAf,EAAuBmB,OAAvB,EAAkCF,QAAQ,CAACQ,GAAT,GAAiBV,IAAI,CAACU,GAA3D,CAA+D,CAC7Df,QAAQ,CAAC,CAACgB,IAAI,CAAC9B,yBAAN,CAAD,CAAR,CACAc,QAAQ,CAAChB,cAAc,CAAC,SAAD,CAAf,CAAR,CACAgB,QAAQ,CAACb,YAAY,EAAb,CAAR,CACD,CAJD,IAIK,CACDI,OAAO,CAACc,IAAI,CAACf,IAAN,CAAP,CACAG,QAAQ,CAACY,IAAI,CAACb,KAAN,CAAR,CACH,CAEJ,CACF,CAdQ,CAcN,CAACQ,QAAD,CAAUX,OAAV,CAAkBkB,QAAlB,CAA2BF,IAA3B,CAAgCI,OAAhC,CAdM,CAAT,CAgBA,GAAMQ,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,CAAD,CAAO,CAC3BA,CAAC,CAACC,cAAF,GACA,GAAGvB,QAAQ,GAAKF,eAAhB,CAAgC,CAC7BK,UAAU,CAAC,yBAAD,CAAV,CACF,CAFD,IAEK,CACFC,QAAQ,CAACf,iBAAiB,CAAC,CACxB,KAAKoB,IAAI,CAACU,GADc,CAExB,OAAOzB,IAFiB,CAGxB,QAAQE,KAHgB,CAIxB,WAAWI,QAJa,CAAD,CAAlB,CAAR,CAQDG,UAAU,CAAC,EAAD,CAAV,CACD,CAEF,CAhBD,CAiBA,mBACI,MAAC,GAAD,yBACI,MAAC,GAAD,EAAK,EAAE,CAAE,CAAT,wBACG,oCADH,CAEID,OAAO,eAAI,KAAC,OAAD,EAAS,OAAO,CAAC,QAAjB,UAA2BA,OAA3B,EAFf,CAGCK,KAAK,eAAI,KAAC,OAAD,EAAS,OAAO,CAAC,QAAjB,UAA2BA,KAA3B,EAHV,CAILC,OAAO,eAAI,KAAC,MAAD,IAJN,cAKN,MAAC,IAAD,EAAM,QAAQ,CAAEa,aAAhB,wBACA,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,MAAtB,wBACI,KAAC,IAAD,CAAM,KAAN,mBADJ,cAEI,KAAC,IAAD,CAAM,OAAN,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,MAFP,CAGE,WAAW,CAAC,YAHd,CAIE,KAAK,CAAE3B,IAJT,CAKE,QAAQ,CAAE,kBAAC4B,CAAD,QAAO3B,CAAAA,OAAO,CAAC2B,CAAC,CAACE,MAAF,CAASC,KAAV,CAAd,EALZ,EAFJ,GADA,cAaE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,OAAtB,wBACE,KAAC,IAAD,CAAM,KAAN,4BADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,OAFP,CAGE,WAAW,CAAC,aAHd,CAIE,KAAK,CAAE7B,KAJT,CAKE,QAAQ,CAAE,kBAAC0B,CAAD,QAAOzB,CAAAA,QAAQ,CAACyB,CAAC,CAACE,MAAF,CAASC,KAAV,CAAf,EALZ,EAFF,GAbF,cAwBE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,UAAtB,wBACE,KAAC,IAAD,CAAM,KAAN,uBADF,cAEE,KAAC,IAAD,CAAM,OAAN,EAEE,IAAI,CAAC,UAFP,CAGE,WAAW,CAAC,gBAHd,CAIE,KAAK,CAAEzB,QAJT,CAKE,QAAQ,CAAE,kBAACsB,CAAD,QAAOrB,CAAAA,WAAW,CAACqB,CAAC,CAACE,MAAF,CAASC,KAAV,CAAlB,EALZ,EAFF,GAxBF,cAqCE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,iBAAtB,wBACE,KAAC,IAAD,CAAM,KAAN,+BADF,cAEE,KAAC,IAAD,CAAM,OAAN,EAEE,IAAI,CAAC,UAFP,CAGE,WAAW,CAAC,uBAHd,CAIE,KAAK,CAAE3B,eAJT,CAKE,QAAQ,CAAE,kBAACwB,CAAD,QAAOvB,CAAAA,kBAAkB,CAACuB,CAAC,CAACE,MAAF,CAASC,KAAV,CAAzB,EALZ,EAFF,GArCF,cAgDE,KAAC,MAAD,EAAQ,IAAI,CAAC,QAAb,CAAsB,OAAO,CAAC,SAA9B,oBAhDF,GALM,GADJ,cA6DI,MAAC,GAAD,EAAK,EAAE,CAAE,CAAT,wBACG,iCADH,CAEIV,aAAa,cACZ,KAAC,MAAD,IADY,CAEZC,WAAW,cACX,KAAC,OAAD,EAAS,OAAO,CAAC,QAAjB,UAA2BA,WAA3B,EADW,cAET,MAAC,KAAD,EAAO,OAAO,KAAd,CAAe,UAAU,KAAzB,CAA0B,SAAS,CAAC,UAApC,wBACF,oCACI,mCACE,0BADF,cAEE,4BAFF,cAGE,6BAHF,cAIE,4BAJF,cAKE,iCALF,GADJ,EADE,cAWJ,uBACcC,MAAM,CAACS,GAAP,CAAW,SAAAC,KAAK,qBACf,mCACE,oBAAKA,KAAK,CAACR,GAAX,EADF,cAEE,oBAAKQ,KAAK,CAACC,SAAN,CAAgBC,SAAhB,CAA0B,CAA1B,CAA4B,EAA5B,CAAL,EAFF,cAGE,0BAAMF,KAAK,CAACG,UAAZ,GAHF,cAIE,oBAAKH,KAAK,CAACI,MAAN,CAAeJ,KAAK,CAACK,MAAN,CAAaH,SAAb,CAAuB,CAAvB,CAAyB,EAAzB,CAAf,cACH,UAAG,SAAS,CAAC,cAAb,CAA4B,KAAK,CAAE,CAACI,KAAK,CAAC,KAAP,CAAnC,EADF,EAJF,cAOE,iCACE,KAAC,aAAD,EAAe,EAAE,kBAAYN,KAAK,CAACR,GAAlB,CAAjB,uBACA,KAAC,MAAD,EAAQ,SAAS,CAAC,QAAlB,qBADA,EADF,EAPF,GAASQ,KAAK,CAACR,GAAf,CADe,EAAhB,CADd,EAXI,GANP,GA7DJ,GADJ,CAqGH,CAlKD,CAoKA,cAAe3B,CAAAA,aAAf","sourcesContent":["\nimport React, { useState, useEffect } from \"react\";\n\nimport { Form, Button, Row, Col,Table } from \"react-bootstrap\";\nimport { LinkContainer } from \"react-router-bootstrap\";\nimport {Loader} from \"../Loader\";\nimport Message from \"../Message\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getUserDetails, updateUserProfile } from \"../../actions/userActions\";\nimport { USER_UPDATE_PROFILE_RESET } from \"../../constants/userConstants\";\nimport { ListMyOrders } from \"../../actions/orderActions\";\n\n\nconst ProfileScreen = ({history}) => {\n\n    const [name, setName] = useState(\"\");\n    const [email, setEmail] = useState(\"\");\n    const [confirmPassword, setConfirmPassword] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [message, setMessage] = useState(\"\");\n  \n  \n    const dispatch = useDispatch();\n  \n   \n  \n    const userDetails = useSelector(state => state.userDetails);\n    const { error, loading, user} = userDetails;\n\n    const userLogin = useSelector(state => state.userLogin);\n    const { userInfo} = userLogin;\n\n\n\n    const userUpdateProfile = useSelector(state => state.userUpdateProfile);\n    const { success } = userUpdateProfile;\n\n\n    const orderListMy  = useSelector(state => state.orderListMy);\n    const { loading:loadingOrders,error:errorOrders,orders } = orderListMy;\n  \n    useEffect(() => { \n      if (!userInfo) {\n        history.push('/login');\n      }else{\n          if(!user || !user.name || success || userInfo._id !== user._id){\n            dispatch({type:USER_UPDATE_PROFILE_RESET})  \n            dispatch(getUserDetails('profile'))\n            dispatch(ListMyOrders())\n          }else{\n              setName(user.name) \n              setEmail(user.email)\n          }\n          \n      }\n    }, [dispatch,history,userInfo,user,success]);\n  \n    const submitHandler = (e) => {\n      e.preventDefault();\n      if(password !== confirmPassword){\n         setMessage('password does not match')\n      }else{\n         dispatch(updateUserProfile({\n            'id':user._id,\n            'name':name,\n            'email':email,\n            'password':password\n            \n        \n        }))\n        setMessage('')\n      } \n      \n    };\n    return (\n        <Row>\n            <Col md={3}>\n               <h2>User Profile</h2>\n               {message && <Message variant='danger'>{message}</Message>}\n            {error && <Message variant='danger'>{error}</Message>}\n      {loading && <Loader/>}\n      <Form onSubmit={submitHandler}>\n      <Form.Group controlId=\"name\">\n          <Form.Label>Name</Form.Label>\n          <Form.Control\n            required\n            type=\"name\"\n            placeholder=\"Enter Name\"\n            value={name}\n            onChange={(e) => setName(e.target.value)}\n          ></Form.Control>\n        </Form.Group>\n\n\n        <Form.Group controlId=\"email\">\n          <Form.Label>Email Address</Form.Label>\n          <Form.Control\n            required\n            type=\"email\"\n            placeholder=\"Enter Email\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n          ></Form.Control>\n        </Form.Group>\n\n        <Form.Group controlId=\"password\">\n          <Form.Label>Password</Form.Label>\n          <Form.Control\n            \n            type=\"password\"\n            placeholder=\"Enter Password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n          ></Form.Control>\n        </Form.Group>\n\n\n\n        <Form.Group controlId=\"passwordConfirm\">\n          <Form.Label>Confirm Password</Form.Label>\n          <Form.Control\n         \n            type=\"password\"\n            placeholder=\"Enter ConfirmPassword\"\n            value={confirmPassword}\n            onChange={(e) => setConfirmPassword(e.target.value)}\n          ></Form.Control>\n        </Form.Group>\n       \n        <Button type=\"submit\" variant=\"primary\">\n          Update\n        </Button>\n\n      </Form>\n            </Col>\n\n            <Col md={9}>\n               <h2>My Orders</h2>\n               {loadingOrders ? (\n                 <Loader/>\n               ):errorOrders ? (\n                 <Message variant='danger'>{errorOrders}</Message>\n               ) :(<Table striped responsive className='table-sm'>\n                 <thead>\n                     <tr>\n                       <th>ID</th>\n                       <th>Date</th>\n                       <th>Total</th>\n                       <th>Paid</th>\n                       <th>Delivered</th>\n                     \n                     </tr>\n                 </thead>\n               <tbody>\n                            {orders.map(order=>(\n                              <tr key={order._id}>\n                                <td>{order._id}</td>\n                                <td>{order.createdAt.substring(0,10)}</td>\n                                <td>${order.totalPrice}</td>\n                                <td>{order.isPaid ? order.paidAt.substring(0,10) : (\n                                  <i className='fas fa-times' style={{color:'red'}}></i>\n                                )}</td>\n                                <td>\n                                  <LinkContainer to={`/order/${order._id}` }>\n                                  <Button className='btn-sm'>Details</Button>\n                                  </LinkContainer>\n                                </td>\n                              </tr>\n                            ))}\n\n                 </tbody>           \n               </Table>) }\n            </Col>\n        </Row>\n    )\n}\n\nexport default ProfileScreen\n"]},"metadata":{},"sourceType":"module"}